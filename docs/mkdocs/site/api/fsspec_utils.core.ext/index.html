
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="⚠️ DEPRECATED - Use fsspeckit instead. Enhanced utilities for fsspec filesystems.">
      
      
      
        <link rel="canonical" href="https://legout.github.com/fsspec-utils/api/fsspec_utils.core.ext/">
      
      
        <link rel="prev" href="../fsspec_utils.core.base/">
      
      
        <link rel="next" href="../fsspec_utils.storage_options.base/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>fsspec_utils.core.ext - fsspec-utils (Deprecated)</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.e53b48f4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#fsspec_utilscoreext-api-documentation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="fsspec-utils (Deprecated)" class="md-header__button md-logo" aria-label="fsspec-utils (Deprecated)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            fsspec-utils (Deprecated)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              fsspec_utils.core.ext
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="teal"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="teal"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/legout/fsspec-utils" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    legout/fsspec-utils
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../installation/" class="md-tabs__link">
        
  
  
    
  
  Installation

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../MIGRATION.md" class="md-tabs__link">
        
  
  
    
  
  Migration Guide

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../quickstart/" class="md-tabs__link">
        
  
  
    
  
  Quickstart

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../architecture/" class="md-tabs__link">
        
  
  
    
  
  Architecture

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../advanced/" class="md-tabs__link">
        
  
  
    
  
  Advanced Usage

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../contributing/" class="md-tabs__link">
        
  
  
    
  
  Contributing

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="fsspec-utils (Deprecated)" class="md-nav__button md-logo" aria-label="fsspec-utils (Deprecated)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    fsspec-utils (Deprecated)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/legout/fsspec-utils" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    legout/fsspec-utils
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../MIGRATION.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Migration Guide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quickstart
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Advanced Usage
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fsspec-utils API Reference
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2" checked>
        
          
          <label class="md-nav__link" for="__nav_8_2" id="__nav_8_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Core
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8_2">
            <span class="md-nav__icon md-icon"></span>
            Core
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fsspec_utils.core.base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fsspec_utils.core.base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    fsspec_utils.core.ext
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    fsspec_utils.core.ext
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#path_to_glob" class="md-nav__link">
    <span class="md-ellipsis">
      path_to_glob()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#read_json_file" class="md-nav__link">
    <span class="md-ellipsis">
      read_json_file()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#read_json" class="md-nav__link">
    <span class="md-ellipsis">
      read_json()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#read_csv_file" class="md-nav__link">
    <span class="md-ellipsis">
      read_csv_file()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#read_csv" class="md-nav__link">
    <span class="md-ellipsis">
      read_csv()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#read_parquet_file" class="md-nav__link">
    <span class="md-ellipsis">
      read_parquet_file()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#read_parquet" class="md-nav__link">
    <span class="md-ellipsis">
      read_parquet()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#read_files" class="md-nav__link">
    <span class="md-ellipsis">
      read_files()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyarrow_dataset" class="md-nav__link">
    <span class="md-ellipsis">
      pyarrow_dataset()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyarrow_parquet_dataset" class="md-nav__link">
    <span class="md-ellipsis">
      pyarrow_parquet_dataset()
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_3" >
        
          
          <label class="md-nav__link" for="__nav_8_3" id="__nav_8_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Storage Options
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_3">
            <span class="md-nav__icon md-icon"></span>
            Storage Options
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fsspec_utils.storage_options.base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fsspec_utils.storage_options.base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fsspec_utils.storage_options.cloud/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fsspec_utils.storage_options.cloud
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fsspec_utils.storage_options.core/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fsspec_utils.storage_options.core
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fsspec_utils.storage_options.git/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fsspec_utils.storage_options.git
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_4" >
        
          
          <label class="md-nav__link" for="__nav_8_4" id="__nav_8_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Utilities
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_4">
            <span class="md-nav__icon md-icon"></span>
            Utilities
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fsspec_utils.utils.datetime/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fsspec_utils.utils.datetime
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fsspec_utils.utils.logging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fsspec_utils.utils.logging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fsspec_utils.utils.misc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fsspec_utils.utils.misc
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fsspec_utils.utils.polars/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fsspec_utils.utils.polars
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fsspec_utils.utils.pyarrow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fsspec_utils.utils.pyarrow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fsspec_utils.utils.sql/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fsspec_utils.utils.sql
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fsspec_utils.utils.types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fsspec_utils.utils.types
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="fsspec_utilscoreext-api-documentation"><code>fsspec_utils.core.ext</code> API Documentation<a class="headerlink" href="#fsspec_utilscoreext-api-documentation" title="Permanent link">&para;</a></h1>
<p>This module provides extended functionalities for <code>fsspec.AbstractFileSystem</code>, including methods for reading and writing various file formats (JSON, CSV, Parquet) with advanced options like batch processing, parallelization, and data type optimization. It also includes functions for creating PyArrow datasets.</p>
<hr />
<h2 id="path_to_glob"><code>path_to_glob()</code><a class="headerlink" href="#path_to_glob" title="Permanent link">&para;</a></h2>
<p>Convert a path to a glob pattern for file matching.</p>
<p>Intelligently converts paths to glob patterns that match files of the specified format, handling various directory and wildcard patterns.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>path</code></td>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;">Base path to convert. Can include wildcards (<code>*</code> or <code>**</code>). Examples: "data/", "data/<em>.json", "data/*</em>"</td>
</tr>
<tr>
<td style="text-align: left;"><code>format</code></td>
<td style="text-align: left;"><code>str | None</code></td>
<td style="text-align: left;">File format to match (without dot). If None, inferred from path. Examples: "json", "csv", "parquet"</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align: left;">Returns</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;">Glob pattern that matches files of specified format. Examples: "data/**/<em>.json", "data/</em>.csv"</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="c1"># Basic directory</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="n">path_to_glob</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="s2">&quot;json&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="c1"># &#39;data/**/*.json&#39;</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="c1"># With wildcards</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="n">path_to_glob</span><span class="p">(</span><span class="s2">&quot;data/**&quot;</span><span class="p">,</span> <span class="s2">&quot;csv&quot;</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="c1"># &#39;data/**/*.csv&#39;</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="c1"># Format inference</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="n">path_to_glob</span><span class="p">(</span><span class="s2">&quot;data/file.parquet&quot;</span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="c1"># &#39;data/file.parquet&#39;</span>
</code></pre></div></td></tr></table></div>
<hr />
<h2 id="read_json_file"><code>read_json_file()</code><a class="headerlink" href="#read_json_file" title="Permanent link">&para;</a></h2>
<p>Read a single JSON file from any filesystem.</p>
<p>A public wrapper around <code>_read_json_file</code> providing a clean interface for reading individual JSON files.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>self</code></td>
<td style="text-align: left;"><code>AbstractFileSystem</code></td>
<td style="text-align: left;">Filesystem instance to use for reading</td>
</tr>
<tr>
<td style="text-align: left;"><code>path</code></td>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;">Path to JSON file to read</td>
</tr>
<tr>
<td style="text-align: left;"><code>include_file_path</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Whether to return dict with filepath as key</td>
</tr>
<tr>
<td style="text-align: left;"><code>jsonlines</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Whether to read as JSON Lines format</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align: left;">Returns</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>dict</code> or <code>list[dict]</code></td>
<td style="text-align: left;"><code>dict</code> or <code>list[dict]</code></td>
<td style="text-align: left;">Parsed JSON data. For regular JSON, returns a dict. For JSON Lines, returns a list of dicts. If <code>include_file_path=True</code>, returns <code>{filepath: data}</code>.</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-1-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-1-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-1-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-1-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-1-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-1-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-1-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-1-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-1-10">10</a></span>
<span class="normal"><a href="#__codelineno-1-11">11</a></span>
<span class="normal"><a href="#__codelineno-1-12">12</a></span>
<span class="normal"><a href="#__codelineno-1-13">13</a></span>
<span class="normal"><a href="#__codelineno-1-14">14</a></span>
<span class="normal"><a href="#__codelineno-1-15">15</a></span>
<span class="normal"><a href="#__codelineno-1-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">fsspec.implementations.local</span><span class="w"> </span><span class="kn">import</span> <span class="n">LocalFileSystem</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="n">fs</span> <span class="o">=</span> <span class="n">LocalFileSystem</span><span class="p">()</span>
<a id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="c1"># Read regular JSON</span>
<a id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="n">data</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">read_json_file</span><span class="p">(</span><span class="s2">&quot;config.json&quot;</span><span class="p">)</span>
<a id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;setting&quot;</span><span class="p">])</span>
<a id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="c1"># &#39;value&#39;</span>
<a id="__codelineno-1-8" name="__codelineno-1-8"></a>
<a id="__codelineno-1-9" name="__codelineno-1-9"></a><span class="c1"># Read JSON Lines with filepath</span>
<a id="__codelineno-1-10" name="__codelineno-1-10"></a><span class="n">data</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">read_json_file</span><span class="p">(</span>
<a id="__codelineno-1-11" name="__codelineno-1-11"></a>    <span class="s2">&quot;logs.jsonl&quot;</span><span class="p">,</span>
<a id="__codelineno-1-12" name="__codelineno-1-12"></a>    <span class="n">include_file_path</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-1-13" name="__codelineno-1-13"></a>    <span class="n">jsonlines</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-1-14" name="__codelineno-1-14"></a><span class="p">)</span>
<a id="__codelineno-1-15" name="__codelineno-1-15"></a><span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-1-16" name="__codelineno-1-16"></a><span class="c1"># &#39;logs.jsonl&#39;</span>
</code></pre></div></td></tr></table></div>
<hr />
<h2 id="read_json"><code>read_json()</code><a class="headerlink" href="#read_json" title="Permanent link">&para;</a></h2>
<p>Read JSON data from one or more files with powerful options.</p>
<p>Provides a flexible interface for reading JSON data with support for:</p>
<ul>
<li>Single file or multiple files</li>
<li>Regular JSON or JSON Lines format</li>
<li>Batch processing for large datasets</li>
<li>Parallel processing</li>
<li>DataFrame conversion</li>
<li>File path tracking</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>path</code></td>
<td style="text-align: left;"><code>str</code> or <code>list[str]</code></td>
<td style="text-align: left;">Path(s) to JSON file(s). Can be: - Single path string (globs supported) - List of path strings</td>
</tr>
<tr>
<td style="text-align: left;"><code>batch_size</code></td>
<td style="text-align: left;"><code>int | None</code></td>
<td style="text-align: left;">If set, enables batch reading with this many files per batch</td>
</tr>
<tr>
<td style="text-align: left;"><code>include_file_path</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Include source filepath in output</td>
</tr>
<tr>
<td style="text-align: left;"><code>jsonlines</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Whether to read as JSON Lines format</td>
</tr>
<tr>
<td style="text-align: left;"><code>as_dataframe</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Convert output to Polars DataFrame(s)</td>
</tr>
<tr>
<td style="text-align: left;"><code>concat</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Combine multiple files/batches into single result</td>
</tr>
<tr>
<td style="text-align: left;"><code>use_threads</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Enable parallel file reading</td>
</tr>
<tr>
<td style="text-align: left;"><code>verbose</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Print progress information</td>
</tr>
<tr>
<td style="text-align: left;"><code>opt_dtypes</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Optimize DataFrame dtypes for performance</td>
</tr>
<tr>
<td style="text-align: left;"><code>**kwargs</code></td>
<td style="text-align: left;"><code>Any</code></td>
<td style="text-align: left;">Additional arguments passed to DataFrame conversion</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align: left;">Returns</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>dict</code> or <code>list[dict]</code> or <code>pl.DataFrame</code> or <code>list[pl.DataFrame]</code> or <code>Generator</code></td>
<td style="text-align: left;">Various types depending on arguments: - <code>dict</code>: Single JSON file as dictionary - <code>list[dict]</code>: Multiple JSON files as list of dictionaries - <code>pl.DataFrame</code>: Single or concatenated DataFrame - <code>list[pl.DataFrame]</code>: List of Dataframes (if <code>concat=False</code>) - <code>Generator</code>: If <code>batch_size</code> set, yields batches of above types</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-2-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-2-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-2-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-2-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-2-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-2-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-2-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-2-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-2-10">10</a></span>
<span class="normal"><a href="#__codelineno-2-11">11</a></span>
<span class="normal"><a href="#__codelineno-2-12">12</a></span>
<span class="normal"><a href="#__codelineno-2-13">13</a></span>
<span class="normal"><a href="#__codelineno-2-14">14</a></span>
<span class="normal"><a href="#__codelineno-2-15">15</a></span>
<span class="normal"><a href="#__codelineno-2-16">16</a></span>
<span class="normal"><a href="#__codelineno-2-17">17</a></span>
<span class="normal"><a href="#__codelineno-2-18">18</a></span>
<span class="normal"><a href="#__codelineno-2-19">19</a></span>
<span class="normal"><a href="#__codelineno-2-20">20</a></span>
<span class="normal"><a href="#__codelineno-2-21">21</a></span>
<span class="normal"><a href="#__codelineno-2-22">22</a></span>
<span class="normal"><a href="#__codelineno-2-23">23</a></span>
<span class="normal"><a href="#__codelineno-2-24">24</a></span>
<span class="normal"><a href="#__codelineno-2-25">25</a></span>
<span class="normal"><a href="#__codelineno-2-26">26</a></span>
<span class="normal"><a href="#__codelineno-2-27">27</a></span>
<span class="normal"><a href="#__codelineno-2-28">28</a></span>
<span class="normal"><a href="#__codelineno-2-29">29</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">fsspec.implementations.local</span><span class="w"> </span><span class="kn">import</span> <span class="n">LocalFileSystem</span>
<a id="__codelineno-2-2" name="__codelineno-2-2"></a>
<a id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="n">fs</span> <span class="o">=</span> <span class="n">LocalFileSystem</span><span class="p">()</span>
<a id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="c1"># Read all JSON files in directory</span>
<a id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="n">df</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
<a id="__codelineno-2-6" name="__codelineno-2-6"></a>    <span class="s2">&quot;data/*.json&quot;</span><span class="p">,</span>
<a id="__codelineno-2-7" name="__codelineno-2-7"></a>    <span class="n">as_dataframe</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-2-8" name="__codelineno-2-8"></a>    <span class="n">concat</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-2-9" name="__codelineno-2-9"></a><span class="p">)</span>
<a id="__codelineno-2-10" name="__codelineno-2-10"></a><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<a id="__codelineno-2-11" name="__codelineno-2-11"></a><span class="c1"># (1000, 5)  # Combined data from all files</span>
<a id="__codelineno-2-12" name="__codelineno-2-12"></a>
<a id="__codelineno-2-13" name="__codelineno-2-13"></a><span class="c1"># Batch process large dataset</span>
<a id="__codelineno-2-14" name="__codelineno-2-14"></a><span class="k">for</span> <span class="n">batch_df</span> <span class="ow">in</span> <span class="n">fs</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
<a id="__codelineno-2-15" name="__codelineno-2-15"></a>    <span class="s2">&quot;logs/*.jsonl&quot;</span><span class="p">,</span>
<a id="__codelineno-2-16" name="__codelineno-2-16"></a>    <span class="n">batch_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<a id="__codelineno-2-17" name="__codelineno-2-17"></a>    <span class="n">jsonlines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-2-18" name="__codelineno-2-18"></a>    <span class="n">include_file_path</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-2-19" name="__codelineno-2-19"></a><span class="p">):</span>
<a id="__codelineno-2-20" name="__codelineno-2-20"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Processing </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">batch_df</span><span class="p">)</span><span class="si">}</span><span class="s2"> records&quot;</span><span class="p">)</span>
<a id="__codelineno-2-21" name="__codelineno-2-21"></a>
<a id="__codelineno-2-22" name="__codelineno-2-22"></a><span class="c1"># Parallel read with custom options</span>
<a id="__codelineno-2-23" name="__codelineno-2-23"></a><span class="n">dfs</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
<a id="__codelineno-2-24" name="__codelineno-2-24"></a>    <span class="p">[</span><span class="s2">&quot;file1.json&quot;</span><span class="p">,</span> <span class="s2">&quot;file2.json&quot;</span><span class="p">],</span>
<a id="__codelineno-2-25" name="__codelineno-2-25"></a>    <span class="n">use_threads</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-2-26" name="__codelineno-2-26"></a>    <span class="n">concat</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-2-27" name="__codelineno-2-27"></a>    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-2-28" name="__codelineno-2-28"></a><span class="p">)</span>
<a id="__codelineno-2-29" name="__codelineno-2-29"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Read </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">dfs</span><span class="p">)</span><span class="si">}</span><span class="s2"> files&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<hr />
<h2 id="read_csv_file"><code>read_csv_file()</code><a class="headerlink" href="#read_csv_file" title="Permanent link">&para;</a></h2>
<p>Read a single CSV file from any filesystem.</p>
<p>Internal function that handles reading individual CSV files and optionally adds the source filepath as a column.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>self</code></td>
<td style="text-align: left;"><code>AbstractFileSystem</code></td>
<td style="text-align: left;">Filesystem instance to use for reading</td>
</tr>
<tr>
<td style="text-align: left;"><code>path</code></td>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;">Path to CSV file</td>
</tr>
<tr>
<td style="text-align: left;"><code>include_file_path</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Add source filepath as a column</td>
</tr>
<tr>
<td style="text-align: left;"><code>opt_dtypes</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Optimize DataFrame dtypes</td>
</tr>
<tr>
<td style="text-align: left;"><code>**kwargs</code></td>
<td style="text-align: left;"><code>Any</code></td>
<td style="text-align: left;">Additional arguments passed to <code>pl.read_csv()</code></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align: left;">Returns</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>pl.DataFrame</code></td>
<td style="text-align: left;"><code>pl.DataFrame</code></td>
<td style="text-align: left;">DataFrame containing CSV data</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-3-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-3-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-3-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-3-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-3-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-3-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-3-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-3-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-3-10">10</a></span>
<span class="normal"><a href="#__codelineno-3-11">11</a></span>
<span class="normal"><a href="#__codelineno-3-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">fsspec.implementations.local</span><span class="w"> </span><span class="kn">import</span> <span class="n">LocalFileSystem</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="n">fs</span> <span class="o">=</span> <span class="n">LocalFileSystem</span><span class="p">()</span>
<a id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="c1"># This example assumes _read_csv_file is an internal method or needs to be called differently.</span>
<a id="__codelineno-3-5" name="__codelineno-3-5"></a><span class="c1"># For public use, you would typically use fs.read_csv().</span>
<a id="__codelineno-3-6" name="__codelineno-3-6"></a><span class="c1"># df = fs.read_csv_file(</span>
<a id="__codelineno-3-7" name="__codelineno-3-7"></a><span class="c1">#     &quot;data.csv&quot;,</span>
<a id="__codelineno-3-8" name="__codelineno-3-8"></a><span class="c1">#     include_file_path=True,</span>
<a id="__codelineno-3-9" name="__codelineno-3-9"></a><span class="c1">#     delimiter=&quot;|&quot;</span>
<a id="__codelineno-3-10" name="__codelineno-3-10"></a><span class="c1"># )</span>
<a id="__codelineno-3-11" name="__codelineno-3-11"></a><span class="c1"># print(&quot;file_path&quot; in df.columns)</span>
<a id="__codelineno-3-12" name="__codelineno-3-12"></a><span class="c1"># True</span>
</code></pre></div></td></tr></table></div>
<hr />
<h2 id="read_csv"><code>read_csv()</code><a class="headerlink" href="#read_csv" title="Permanent link">&para;</a></h2>
<p>Read CSV data from one or more files with powerful options.</p>
<p>Provides a flexible interface for reading CSV files with support for:</p>
<ul>
<li>Single file or multiple files</li>
<li>Batch processing for large datasets</li>
<li>Parallel</li>
<li>File path tracking</li>
<li>Polars DataFrame output</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>path</code></td>
<td style="text-align: left;"><code>str</code> or <code>list[str]</code></td>
<td style="text-align: left;">Path(s) to CSV file(s). Can be: - Single path string (globs supported) - List of path strings</td>
</tr>
<tr>
<td style="text-align: left;"><code>batch_size</code></td>
<td style="text-align: left;"><code>int | None</code></td>
<td style="text-align: left;">If set, enables batch reading with this many files per batch</td>
</tr>
<tr>
<td style="text-align: left;"><code>include_file_path</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Add source filepath as a column</td>
</tr>
<tr>
<td style="text-align: left;"><code>concat</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Combine multiple files/batches into single DataFrame</td>
</tr>
<tr>
<td style="text-align: left;"><code>use_threads</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Enable parallel file reading</td>
</tr>
<tr>
<td style="text-align: left;"><code>verbose</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Print progress information</td>
</tr>
<tr>
<td style="text-align: left;"><code>**kwargs</code></td>
<td style="text-align: left;"><code>Any</code></td>
<td style="text-align: left;">Additional arguments passed to <code>pl.read_csv()</code></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align: left;">Returns</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>pl.DataFrame</code> or <code>list[pl.DataFrame]</code> or <code>Generator</code></td>
<td style="text-align: left;">Various types depending on arguments: - <code>pl.DataFrame</code>: Single or concatenated DataFrame - <code>list[pl.DataFrame]</code>: List of DataFrames (if <code>concat=False</code>) - <code>Generator</code>: If <code>batch_size</code> set, yields batches of above types</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-4-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-4-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-4-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-4-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-4-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-4-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-4-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-4-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-4-10">10</a></span>
<span class="normal"><a href="#__codelineno-4-11">11</a></span>
<span class="normal"><a href="#__codelineno-4-12">12</a></span>
<span class="normal"><a href="#__codelineno-4-13">13</a></span>
<span class="normal"><a href="#__codelineno-4-14">14</a></span>
<span class="normal"><a href="#__codelineno-4-15">15</a></span>
<span class="normal"><a href="#__codelineno-4-16">16</a></span>
<span class="normal"><a href="#__codelineno-4-17">17</a></span>
<span class="normal"><a href="#__codelineno-4-18">18</a></span>
<span class="normal"><a href="#__codelineno-4-19">19</a></span>
<span class="normal"><a href="#__codelineno-4-20">20</a></span>
<span class="normal"><a href="#__codelineno-4-21">21</a></span>
<span class="normal"><a href="#__codelineno-4-22">22</a></span>
<span class="normal"><a href="#__codelineno-4-23">23</a></span>
<span class="normal"><a href="#__codelineno-4-24">24</a></span>
<span class="normal"><a href="#__codelineno-4-25">25</a></span>
<span class="normal"><a href="#__codelineno-4-26">26</a></span>
<span class="normal"><a href="#__codelineno-4-27">27</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">fsspec.implementations.local</span><span class="w"> </span><span class="kn">import</span> <span class="n">LocalFileSystem</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="n">fs</span> <span class="o">=</span> <span class="n">LocalFileSystem</span><span class="p">()</span>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="c1"># Read all CSVs in directory</span>
<a id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="n">df</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
<a id="__codelineno-4-6" name="__codelineno-4-6"></a>    <span class="s2">&quot;data/*.csv&quot;</span><span class="p">,</span>
<a id="__codelineno-4-7" name="__codelineno-4-7"></a>    <span class="n">include_file_path</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-4-8" name="__codelineno-4-8"></a><span class="p">)</span>
<a id="__codelineno-4-9" name="__codelineno-4-9"></a><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<a id="__codelineno-4-10" name="__codelineno-4-10"></a><span class="c1"># [&#39;file_path&#39;, &#39;col1&#39;, &#39;col2&#39;, ...]</span>
<a id="__codelineno-4-11" name="__codelineno-4-11"></a>
<a id="__codelineno-4-12" name="__codelineno-4-12"></a><span class="c1"># Batch process large dataset</span>
<a id="__codelineno-4-13" name="__codelineno-4-13"></a><span class="k">for</span> <span class="n">batch_df</span> <span class="ow">in</span> <span class="n">fs</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
<a id="__codelineno-4-14" name="__codelineno-4-14"></a>    <span class="s2">&quot;logs/*.csv&quot;</span><span class="p">,</span>
<a id="__codelineno-4-15" name="__codelineno-4-15"></a>    <span class="n">batch_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<a id="__codelineno-4-16" name="__codelineno-4-16"></a>    <span class="n">use_threads</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-4-17" name="__codelineno-4-17"></a>    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-4-18" name="__codelineno-4-18"></a><span class="p">):</span>
<a id="__codelineno-4-19" name="__codelineno-4-19"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Processing </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">batch_df</span><span class="p">)</span><span class="si">}</span><span class="s2"> rows&quot;</span><span class="p">)</span>
<a id="__codelineno-4-20" name="__codelineno-4-20"></a>
<a id="__codelineno-4-21" name="__codelineno-4-21"></a><span class="c1"># Multiple files without concatenation</span>
<a id="__codelineno-4-22" name="__codelineno-4-22"></a><span class="n">dfs</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
<a id="__codelineno-4-23" name="__codelineno-4-23"></a>    <span class="p">[</span><span class="s2">&quot;file1.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;file2.csv&quot;</span><span class="p">],</span>
<a id="__codelineno-4-24" name="__codelineno-4-24"></a>    <span class="n">concat</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-4-25" name="__codelineno-4-25"></a>    <span class="n">use_threads</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-4-26" name="__codelineno-4-26"></a><span class="p">)</span>
<a id="__codelineno-4-27" name="__codelineno-4-27"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Read </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">dfs</span><span class="p">)</span><span class="si">}</span><span class="s2"> files&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<hr />
<h2 id="read_parquet_file"><code>read_parquet_file()</code><a class="headerlink" href="#read_parquet_file" title="Permanent link">&para;</a></h2>
<p>Read a single Parquet file from any filesystem.</p>
<p>Internal function that handles reading individual Parquet files and optionally adds the source filepath as a column.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>self</code></td>
<td style="text-align: left;"><code>AbstractFileSystem</code></td>
<td style="text-align: left;">Filesystem instance to use for reading</td>
</tr>
<tr>
<td style="text-align: left;"><code>path</code></td>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;">Path to Parquet file</td>
</tr>
<tr>
<td style="text-align: left;"><code>include_file_path</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Add source filepath as a column</td>
</tr>
<tr>
<td style="text-align: left;"><code>opt_dtypes</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Optimize DataFrame dtypes</td>
</tr>
<tr>
<td style="text-align: left;"><code>**kwargs</code></td>
<td style="text-align: left;"><code>Any</code></td>
<td style="text-align: left;">Additional arguments passed to <code>pq.read_table()</code></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align: left;">Returns</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>pa.Table</code></td>
<td style="text-align: left;"><code>pa.Table</code></td>
<td style="text-align: left;">PyArrow Table containing Parquet data</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-5-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-5-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-5-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-5-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-5-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-5-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-5-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-5-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-5-10">10</a></span>
<span class="normal"><a href="#__codelineno-5-11">11</a></span>
<span class="normal"><a href="#__codelineno-5-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">fsspec.implementations.local</span><span class="w"> </span><span class="kn">import</span> <span class="n">LocalFileSystem</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a>
<a id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="n">fs</span> <span class="o">=</span> <span class="n">LocalFileSystem</span><span class="p">()</span>
<a id="__codelineno-5-4" name="__codelineno-5-4"></a><span class="c1"># This example assumes _read_parquet_file is an internal method or needs to be called differently.</span>
<a id="__codelineno-5-5" name="__codelineno-5-5"></a><span class="c1"># For public use, you would typically use fs.read_parquet().</span>
<a id="__codelineno-5-6" name="__codelineno-5-6"></a><span class="c1"># table = fs.read_parquet_file(</span>
<a id="__codelineno-5-7" name="__codelineno-5-7"></a><span class="c1">#     &quot;data.parquet&quot;,</span>
<a id="__codelineno-5-8" name="__codelineno-5-8"></a><span class="c1">#     include_file_path=True,</span>
<a id="__codelineno-5-9" name="__codelineno-5-9"></a><span class="c1">#     use_threads=True</span>
<a id="__codelineno-5-10" name="__codelineno-5-10"></a><span class="c1"># )</span>
<a id="__codelineno-5-11" name="__codelineno-5-11"></a><span class="c1"># print(&quot;file_path&quot; in table.column_names)</span>
<a id="__codelineno-5-12" name="__codelineno-5-12"></a><span class="c1"># True</span>
</code></pre></div></td></tr></table></div>
<hr />
<h2 id="read_parquet"><code>read_parquet()</code><a class="headerlink" href="#read_parquet" title="Permanent link">&para;</a></h2>
<p>Read Parquet data with advanced features and optimizations.</p>
<p>Provides a high-performance interface for reading Parquet files with support for:</p>
<ul>
<li>Single file or multiple files</li>
<li>Batch processing for large datasets</li>
<li>Parallel processing</li>
<li>File path tracking</li>
<li>Automatic concatenation</li>
<li>PyArrow Table output</li>
</ul>
<p>The function automatically uses optimal reading strategies:</p>
<ul>
<li>Direct dataset reading for simple cases</li>
<li>Parallel processing for multiple files</li>
<li>Batched reading for memory efficiency</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>path</code></td>
<td style="text-align: left;"><code>str</code> or <code>list[str]</code></td>
<td style="text-align: left;">Path(s) to Parquet file(s). Can be: - Single path string (globs supported) - List of path strings - Directory containing _metadata file</td>
</tr>
<tr>
<td style="text-align: left;"><code>batch_size</code></td>
<td style="text-align: left;"><code>int | None</code></td>
<td style="text-align: left;">If set, enables batch reading with this many files per batch</td>
</tr>
<tr>
<td style="text-align: left;"><code>include_file_path</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Add source filepath as a column</td>
</tr>
<tr>
<td style="text-align: left;"><code>concat</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Combine multiple files/batches into single Table</td>
</tr>
<tr>
<td style="text-align: left;"><code>use_threads</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Enable parallel file reading</td>
</tr>
<tr>
<td style="text-align: left;"><code>verbose</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Print progress information</td>
</tr>
<tr>
<td style="text-align: left;"><code>opt_dtypes</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Optimize Table dtypes for performance</td>
</tr>
<tr>
<td style="text-align: left;"><code>**kwargs</code></td>
<td style="text-align: left;"><code>Any</code></td>
<td style="text-align: left;">Additional arguments passed to <code>pq.read_table()</code></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align: left;">Returns</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>pa.Table</code> or <code>list[pa.Table]</code> or <code>Generator</code></td>
<td style="text-align: left;">Various types depending on arguments: - <code>pa.Table</code>: Single or concatenated Table - <code>list[pa.Table]</code>: List of Tables (if <code>concat=False</code>) - <code>Generator</code>: If <code>batch_size</code> set, yields batches of above types</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-6-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-6-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-6-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-6-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-6-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-6-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-6-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-6-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-6-10">10</a></span>
<span class="normal"><a href="#__codelineno-6-11">11</a></span>
<span class="normal"><a href="#__codelineno-6-12">12</a></span>
<span class="normal"><a href="#__codelineno-6-13">13</a></span>
<span class="normal"><a href="#__codelineno-6-14">14</a></span>
<span class="normal"><a href="#__codelineno-6-15">15</a></span>
<span class="normal"><a href="#__codelineno-6-16">16</a></span>
<span class="normal"><a href="#__codelineno-6-17">17</a></span>
<span class="normal"><a href="#__codelineno-6-18">18</a></span>
<span class="normal"><a href="#__codelineno-6-19">19</a></span>
<span class="normal"><a href="#__codelineno-6-20">20</a></span>
<span class="normal"><a href="#__codelineno-6-21">21</a></span>
<span class="normal"><a href="#__codelineno-6-22">22</a></span>
<span class="normal"><a href="#__codelineno-6-23">23</a></span>
<span class="normal"><a href="#__codelineno-6-24">24</a></span>
<span class="normal"><a href="#__codelineno-6-25">25</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">fsspec.implementations.local</span><span class="w"> </span><span class="kn">import</span> <span class="n">LocalFileSystem</span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a>
<a id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="n">fs</span> <span class="o">=</span> <span class="n">LocalFileSystem</span><span class="p">()</span>
<a id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="c1"># Read all Parquet files in directory</span>
<a id="__codelineno-6-5" name="__codelineno-6-5"></a><span class="n">table</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span>
<a id="__codelineno-6-6" name="__codelineno-6-6"></a>    <span class="s2">&quot;data/*.parquet&quot;</span><span class="p">,</span>
<a id="__codelineno-6-7" name="__codelineno-6-7"></a>    <span class="n">include_file_path</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-6-8" name="__codelineno-6-8"></a><span class="p">)</span>
<a id="__codelineno-6-9" name="__codelineno-6-9"></a><span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">column_names</span><span class="p">)</span>
<a id="__codelineno-6-10" name="__codelineno-6-10"></a><span class="c1"># [&#39;file_path&#39;, &#39;col1&#39;, &#39;col2&#39;, ...]</span>
<a id="__codelineno-6-11" name="__codelineno-6-11"></a>
<a id="__codelineno-6-12" name="__codelineno-6-12"></a><span class="c1"># Batch process large dataset</span>
<a id="__codelineno-6-13" name="__codelineno-6-13"></a><span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">fs</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span>
<a id="__codelineno-6-14" name="__codelineno-6-14"></a>    <span class="s2">&quot;data/*.parquet&quot;</span><span class="p">,</span>
<a id="__codelineno-6-15" name="__codelineno-6-15"></a>    <span class="n">batch_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<a id="__codelineno-6-16" name="__codelineno-6-16"></a>    <span class="n">use_threads</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-6-17" name="__codelineno-6-17"></a><span class="p">):</span>
<a id="__codelineno-6-18" name="__codelineno-6-18"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Processing </span><span class="si">{</span><span class="n">batch</span><span class="o">.</span><span class="n">num_rows</span><span class="si">}</span><span class="s2"> rows&quot;</span><span class="p">)</span>
<a id="__codelineno-6-19" name="__codelineno-6-19"></a>
<a id="__codelineno-6-20" name="__codelineno-6-20"></a><span class="c1"># Read from directory with metadata</span>
<a id="__codelineno-6-21" name="__codelineno-6-21"></a><span class="n">table</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span>
<a id="__codelineno-6-22" name="__codelineno-6-22"></a>    <span class="s2">&quot;data/&quot;</span><span class="p">,</span>  <span class="c1"># Contains _metadata</span>
<a id="__codelineno-6-23" name="__codelineno-6-23"></a>    <span class="n">use_threads</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-6-24" name="__codelineno-6-24"></a><span class="p">)</span>
<a id="__codelineno-6-25" name="__codelineno-6-25"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total rows: </span><span class="si">{</span><span class="n">table</span><span class="o">.</span><span class="n">num_rows</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<hr />
<h2 id="read_files"><code>read_files()</code><a class="headerlink" href="#read_files" title="Permanent link">&para;</a></h2>
<p>Universal interface for reading data files of any supported format.</p>
<p>A unified API that automatically delegates to the appropriate reading function based on file format, while preserving all advanced features like:</p>
<ul>
<li>Batch processing</li>
<li>Parallel reading</li>
<li>File path tracking</li>
<li>Format-specific optimizations</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>path</code></td>
<td style="text-align: left;"><code>str</code> or <code>list[str]</code></td>
<td style="text-align: left;">Path(s) to data file(s). Can be: - Single path string (globs supported) - List of path strings</td>
</tr>
<tr>
<td style="text-align: left;"><code>format</code></td>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;">File format to read. Supported values: - "json": Regular JSON or JSON Lines - "csv": CSV files - "parquet": Parquet files</td>
</tr>
<tr>
<td style="text-align: left;"><code>batch_size</code></td>
<td style="text-align: left;"><code>int | None</code></td>
<td style="text-align: left;">If set, enables batch reading with this many files per batch</td>
</tr>
<tr>
<td style="text-align: left;"><code>include_file_path</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Add source filepath as column/field</td>
</tr>
<tr>
<td style="text-align: left;"><code>concat</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Combine multiple files/batches into single result</td>
</tr>
<tr>
<td style="text-align: left;"><code>jsonlines</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">For JSON format, whether to read as JSON Lines</td>
</tr>
<tr>
<td style="text-align: left;"><code>use_threads</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Enable parallel file reading</td>
</tr>
<tr>
<td style="text-align: left;"><code>verbose</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Print progress information</td>
</tr>
<tr>
<td style="text-align: left;"><code>opt_dtypes</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Optimize DataFrame/Arrow Table dtypes for performance</td>
</tr>
<tr>
<td style="text-align: left;"><code>**kwargs</code></td>
<td style="text-align: left;"><code>Any</code></td>
<td style="text-align: left;">Additional format-specific arguments</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align: left;">Returns</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>pl.DataFrame</code> or <code>pa.Table</code> or <code>list[pl.DataFrame]</code> or <code>list[pa.Table]</code> or <code>Generator</code></td>
<td style="text-align: left;">Various types depending on format and arguments: - <code>pl.DataFrame</code>: For CSV and optionally JSON - <code>pa.Table</code>: For Parquet - <code>list[pl.DataFrame</code> or <code>pa.Table]</code>: Without concatenation - <code>Generator</code>: If <code>batch_size</code> set, yields batches</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-7-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-7-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-7-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-7-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-7-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-7-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-7-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-7-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-7-10">10</a></span>
<span class="normal"><a href="#__codelineno-7-11">11</a></span>
<span class="normal"><a href="#__codelineno-7-12">12</a></span>
<span class="normal"><a href="#__codelineno-7-13">13</a></span>
<span class="normal"><a href="#__codelineno-7-14">14</a></span>
<span class="normal"><a href="#__codelineno-7-15">15</a></span>
<span class="normal"><a href="#__codelineno-7-16">16</a></span>
<span class="normal"><a href="#__codelineno-7-17">17</a></span>
<span class="normal"><a href="#__codelineno-7-18">18</a></span>
<span class="normal"><a href="#__codelineno-7-19">19</a></span>
<span class="normal"><a href="#__codelineno-7-20">20</a></span>
<span class="normal"><a href="#__codelineno-7-21">21</a></span>
<span class="normal"><a href="#__codelineno-7-22">22</a></span>
<span class="normal"><a href="#__codelineno-7-23">23</a></span>
<span class="normal"><a href="#__codelineno-7-24">24</a></span>
<span class="normal"><a href="#__codelineno-7-25">25</a></span>
<span class="normal"><a href="#__codelineno-7-26">26</a></span>
<span class="normal"><a href="#__codelineno-7-27">27</a></span>
<span class="normal"><a href="#__codelineno-7-28">28</a></span>
<span class="normal"><a href="#__codelineno-7-29">29</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">fsspec.implementations.local</span><span class="w"> </span><span class="kn">import</span> <span class="n">LocalFileSystem</span>
<a id="__codelineno-7-2" name="__codelineno-7-2"></a>
<a id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="n">fs</span> <span class="o">=</span> <span class="n">LocalFileSystem</span><span class="p">()</span>
<a id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="c1"># Read CSV files</span>
<a id="__codelineno-7-5" name="__codelineno-7-5"></a><span class="n">df</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">read_files</span><span class="p">(</span>
<a id="__codelineno-7-6" name="__codelineno-7-6"></a>    <span class="s2">&quot;data/*.csv&quot;</span><span class="p">,</span>
<a id="__codelineno-7-7" name="__codelineno-7-7"></a>    <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;csv&quot;</span><span class="p">,</span>
<a id="__codelineno-7-8" name="__codelineno-7-8"></a>    <span class="n">include_file_path</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-7-9" name="__codelineno-7-9"></a><span class="p">)</span>
<a id="__codelineno-7-10" name="__codelineno-7-10"></a><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
<a id="__codelineno-7-11" name="__codelineno-7-11"></a><span class="c1"># &lt;class &#39;polars.DataFrame&#39;&gt;</span>
<a id="__codelineno-7-12" name="__codelineno-7-12"></a>
<a id="__codelineno-7-13" name="__codelineno-7-13"></a><span class="c1"># Batch process Parquet files</span>
<a id="__codelineno-7-14" name="__codelineno-7-14"></a><span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">fs</span><span class="o">.</span><span class="n">read_files</span><span class="p">(</span>
<a id="__codelineno-7-15" name="__codelineno-7-15"></a>    <span class="s2">&quot;data/*.parquet&quot;</span><span class="p">,</span>
<a id="__codelineno-7-16" name="__codelineno-7-16"></a>    <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;parquet&quot;</span><span class="p">,</span>
<a id="__codelineno-7-17" name="__codelineno-7-17"></a>    <span class="n">batch_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<a id="__codelineno-7-18" name="__codelineno-7-18"></a>    <span class="n">use_threads</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-7-19" name="__codelineno-7-19"></a><span class="p">):</span>
<a id="__codelineno-7-20" name="__codelineno-7-20"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Batch type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-7-21" name="__codelineno-7-21"></a>
<a id="__codelineno-7-22" name="__codelineno-7-22"></a><span class="c1"># Read JSON Lines</span>
<a id="__codelineno-7-23" name="__codelineno-7-23"></a><span class="n">df</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">read_files</span><span class="p">(</span>
<a id="__codelineno-7-24" name="__codelineno-7-24"></a>    <span class="s2">&quot;logs/*.jsonl&quot;</span><span class="p">,</span>
<a id="__codelineno-7-25" name="__codelineno-7-25"></a>    <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;json&quot;</span><span class="p">,</span>
<a id="__codelineno-7-26" name="__codelineno-7-26"></a>    <span class="n">jsonlines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-7-27" name="__codelineno-7-27"></a>    <span class="n">concat</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-7-28" name="__codelineno-7-28"></a><span class="p">)</span>
<a id="__codelineno-7-29" name="__codelineno-7-29"></a><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<hr />
<h2 id="pyarrow_dataset"><code>pyarrow_dataset()</code><a class="headerlink" href="#pyarrow_dataset" title="Permanent link">&para;</a></h2>
<p>Create a PyArrow dataset from files in any supported format.</p>
<p>Creates a dataset that provides optimized reading and querying capabilities including:</p>
<ul>
<li>Schema inference and enforcement</li>
<li>Partition discovery and pruning</li>
<li>Predicate pushdown</li>
<li>Column projection</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>path</code></td>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;">Base path to dataset files</td>
</tr>
<tr>
<td style="text-align: left;"><code>format</code></td>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;">File format. Currently supports: - "parquet" (default) - "csv" - "json" (experimental)</td>
</tr>
<tr>
<td style="text-align: left;"><code>schema</code></td>
<td style="text-align: left;"><code>pa.Schema | None</code></td>
<td style="text-align: left;">Optional schema to enforce. If None, inferred from data.</td>
</tr>
<tr>
<td style="text-align: left;"><code>partitioning</code></td>
<td style="text-align: left;"><code>str</code> or <code>list[str]</code> or <code>pds.Partitioning</code></td>
<td style="text-align: left;">How the dataset is partitioned. Can be: - <code>str</code>: Single partition field - <code>list[str]</code>: Multiple partition fields - <code>pds.Partitioning</code>: Custom partitioning scheme</td>
</tr>
<tr>
<td style="text-align: left;"><code>**kwargs</code></td>
<td style="text-align: left;"><code>Any</code></td>
<td style="text-align: left;">Additional arguments for dataset creation</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align: left;">Returns</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>pds.Dataset</code></td>
<td style="text-align: left;"><code>pds.Dataset</code></td>
<td style="text-align: left;">PyArrow dataset instance</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-8-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-8-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-8-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-8-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-8-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-8-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-8-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-8-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-8-10">10</a></span>
<span class="normal"><a href="#__codelineno-8-11">11</a></span>
<span class="normal"><a href="#__codelineno-8-12">12</a></span>
<span class="normal"><a href="#__codelineno-8-13">13</a></span>
<span class="normal"><a href="#__codelineno-8-14">14</a></span>
<span class="normal"><a href="#__codelineno-8-15">15</a></span>
<span class="normal"><a href="#__codelineno-8-16">16</a></span>
<span class="normal"><a href="#__codelineno-8-17">17</a></span>
<span class="normal"><a href="#__codelineno-8-18">18</a></span>
<span class="normal"><a href="#__codelineno-8-19">19</a></span>
<span class="normal"><a href="#__codelineno-8-20">20</a></span>
<span class="normal"><a href="#__codelineno-8-21">21</a></span>
<span class="normal"><a href="#__codelineno-8-22">22</a></span>
<span class="normal"><a href="#__codelineno-8-23">23</a></span>
<span class="normal"><a href="#__codelineno-8-24">24</a></span>
<span class="normal"><a href="#__codelineno-8-25">25</a></span>
<span class="normal"><a href="#__codelineno-8-26">26</a></span>
<span class="normal"><a href="#__codelineno-8-27">27</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">fsspec.implementations.local</span><span class="w"> </span><span class="kn">import</span> <span class="n">LocalFileSystem</span>
<a id="__codelineno-8-2" name="__codelineno-8-2"></a>
<a id="__codelineno-8-3" name="__codelineno-8-3"></a><span class="n">fs</span> <span class="o">=</span> <span class="n">LocalFileSystem</span><span class="p">()</span>
<a id="__codelineno-8-4" name="__codelineno-8-4"></a><span class="c1"># Simple Parquet dataset</span>
<a id="__codelineno-8-5" name="__codelineno-8-5"></a><span class="n">ds</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">pyarrow_dataset</span><span class="p">(</span><span class="s2">&quot;data/&quot;</span><span class="p">)</span>
<a id="__codelineno-8-6" name="__codelineno-8-6"></a><span class="nb">print</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">schema</span><span class="p">)</span>
<a id="__codelineno-8-7" name="__codelineno-8-7"></a>
<a id="__codelineno-8-8" name="__codelineno-8-8"></a><span class="c1"># Partitioned dataset</span>
<a id="__codelineno-8-9" name="__codelineno-8-9"></a><span class="n">ds</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">pyarrow_dataset</span><span class="p">(</span>
<a id="__codelineno-8-10" name="__codelineno-8-10"></a>    <span class="s2">&quot;events/&quot;</span><span class="p">,</span>
<a id="__codelineno-8-11" name="__codelineno-8-11"></a>    <span class="n">partitioning</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">]</span>
<a id="__codelineno-8-12" name="__codelineno-8-12"></a><span class="p">)</span>
<a id="__codelineno-8-13" name="__codelineno-8-13"></a><span class="c1"># Query with partition pruning</span>
<a id="__codelineno-8-14" name="__codelineno-8-14"></a><span class="n">table</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">to_table</span><span class="p">(</span>
<a id="__codelineno-8-15" name="__codelineno-8-15"></a>    <span class="nb">filter</span><span class="o">=</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2024</span><span class="p">)</span>
<a id="__codelineno-8-16" name="__codelineno-8-16"></a><span class="p">)</span>
<a id="__codelineno-8-17" name="__codelineno-8-17"></a>
<a id="__codelineno-8-18" name="__codelineno-8-18"></a><span class="c1"># CSV with schema</span>
<a id="__codelineno-8-19" name="__codelineno-8-19"></a><span class="n">ds</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">pyarrow_dataset</span><span class="p">(</span>
<a id="__codelineno-8-20" name="__codelineno-8-20"></a>    <span class="s2">&quot;logs/&quot;</span><span class="p">,</span>
<a id="__codelineno-8-21" name="__codelineno-8-21"></a>    <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;csv&quot;</span><span class="p">,</span>
<a id="__codelineno-8-22" name="__codelineno-8-22"></a>    <span class="n">schema</span><span class="o">=</span><span class="n">pa</span><span class="o">.</span><span class="n">schema</span><span class="p">([</span>
<a id="__codelineno-8-23" name="__codelineno-8-23"></a>        <span class="p">(</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">timestamp</span><span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">)),</span>
<a id="__codelineno-8-24" name="__codelineno-8-24"></a>        <span class="p">(</span><span class="s2">&quot;level&quot;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">string</span><span class="p">()),</span>
<a id="__codelineno-8-25" name="__codelineno-8-25"></a>        <span class="p">(</span><span class="s2">&quot;message&quot;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">string</span><span class="p">())</span>
<a id="__codelineno-8-26" name="__codelineno-8-26"></a>    <span class="p">])</span>
<a id="__codelineno-8-27" name="__codelineno-8-27"></a><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<hr />
<h2 id="pyarrow_parquet_dataset"><code>pyarrow_parquet_dataset()</code><a class="headerlink" href="#pyarrow_parquet_dataset" title="Permanent link">&para;</a></h2>
<p>Create a PyArrow dataset optimized for Parquet files.</p>
<p>Creates a dataset specifically for Parquet data, automatically handling <code>_metadata</code> files for optimized reading.</p>
<p>This function is particularly useful for:</p>
<ul>
<li>Datasets with existing <code>_metadata</code> files</li>
<li>Multi-file datasets that should be treated as one</li>
<li>Partitioned Parquet datasets</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>path</code></td>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;">Path to dataset directory or <code>_metadata</code> file</td>
</tr>
<tr>
<td style="text-align: left;"><code>schema</code></td>
<td style="text-align: left;"><code>pa.Schema | None</code></td>
<td style="text-align: left;">Optional schema to enforce. If None, inferred from data.</td>
</tr>
<tr>
<td style="text-align: left;"><code>partitioning</code></td>
<td style="text-align: left;"><code>str</code> or <code>list[str]</code> or <code>pds.Partitioning</code></td>
<td style="text-align: left;">How the dataset is partitioned. Can be: - <code>str</code>: Single partition field - <code>list[str]</code>: Multiple partition fields - <code>pds.Partitioning</code>: Custom partitioning scheme</td>
</tr>
<tr>
<td style="text-align: left;"><code>**kwargs</code></td>
<td style="text-align: left;"><code>Any</code></td>
<td style="text-align: left;">Additional dataset arguments</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align: left;">Returns</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>pds.Dataset</code></td>
<td style="text-align: left;"><code>pds.Dataset</code></td>
<td style="text-align: left;">PyArrow dataset instance</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-9-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-9-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-9-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-9-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-9-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-9-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-9-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-9-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-9-10">10</a></span>
<span class="normal"><a href="#__codelineno-9-11">11</a></span>
<span class="normal"><a href="#__codelineno-9-12">12</a></span>
<span class="normal"><a href="#__codelineno-9-13">13</a></span>
<span class="normal"><a href="#__codelineno-9-14">14</a></span>
<span class="normal"><a href="#__codelineno-9-15">15</a></span>
<span class="normal"><a href="#__codelineno-9-16">16</a></span>
<span class="normal"><a href="#__codelineno-9-17">17</a></span>
<span class="normal"><a href="#__codelineno-9-18">18</a></span>
<span class="normal"><a href="#__codelineno-9-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">fsspec.implementations.local</span><span class="w"> </span><span class="kn">import</span> <span class="n">LocalFileSystem</span>
<a id="__codelineno-9-2" name="__codelineno-9-2"></a>
<a id="__codelineno-9-3" name="__codelineno-9-3"></a><span class="n">fs</span> <span class="o">=</span> <span class="n">LocalFileSystem</span><span class="p">()</span>
<a id="__codelineno-9-4" name="__codelineno-9-4"></a><span class="c1"># Dataset with _metadata</span>
<a id="__codelineno-9-5" name="__codelineno-9-5"></a><span class="n">ds</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">pyarrow_parquet_dataset</span><span class="p">(</span><span class="s2">&quot;data/_metadata&quot;</span><span class="p">)</span>
<a id="__codelineno-9-6" name="__codelineno-9-6"></a><span class="nb">print</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>  <span class="c1"># Shows all data files</span>
<a id="__codelineno-9-7" name="__codelineno-9-7"></a>
<a id="__codelineno-9-8" name="__codelineno-9-8"></a><span class="c1"># Partitioned dataset directory</span>
<a id="__codelineno-9-9" name="__codelineno-9-9"></a><span class="n">ds</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">pyarrow_parquet_dataset</span><span class="p">(</span>
<a id="__codelineno-9-10" name="__codelineno-9-10"></a>    <span class="s2">&quot;sales/&quot;</span><span class="p">,</span>
<a id="__codelineno-9-11" name="__codelineno-9-11"></a>    <span class="n">partitioning</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;region&quot;</span><span class="p">]</span>
<a id="__codelineno-9-12" name="__codelineno-9-12"></a><span class="p">)</span>
<a id="__codelineno-9-13" name="__codelineno-9-13"></a><span class="c1"># Query with partition pruning</span>
<a id="__codelineno-9-14" name="__codelineno-9-14"></a><span class="n">table</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">to_table</span><span class="p">(</span>
<a id="__codelineno-9-15" name="__codelineno-9-15"></a>    <span class="nb">filter</span><span class="o">=</span><span class="p">(</span>
<a id="__codelineno-9-16" name="__codelineno-9-16"></a>        <span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2024</span><span class="p">)</span> <span class="o">&amp;</span>
<a id="__codelineno-9-17" name="__codelineno-9-17"></a>        <span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s2">&quot;region&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;EMEA&quot;</span><span class="p">)</span>
<a id="__codelineno-9-18" name="__codelineno-9-18"></a>    <span class="p">)</span>
<a id="__codelineno-9-19" name="__codelineno-9-19"></a><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<!-----

## `pydala_dataset()`

Create a Pydala dataset for advanced Parquet operations.

Creates a dataset with additional features beyond PyArrow including:

- Delta table support
- Schema evolution
- Advanced partitioning
- Metadata management
- Sort key optimization

| Parameter | Type | Description |
| :-------- | :--- | :---------- |
| `path` | `str` | Path to dataset directory |
| `partitioning` | `str` or `list[str]` or `pds.Partitioning` | How the dataset is partitioned. Can be: - `str`: Single partition field - `list[str]`: Multiple partition fields - `pds.Partitioning`: Custom partitioning scheme |
| `**kwargs` | `Any` | Additional dataset configuration |

| Returns | Type | Description |
| :------ | :--- | :---------- |
| `ParquetDataset` | `ParquetDataset` | Pydala dataset instance |

**Example:**

<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-10-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-10-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-10-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-10-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-10-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-10-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-10-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-10-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-10-10">10</a></span>
<span class="normal"><a href="#__codelineno-10-11">11</a></span>
<span class="normal"><a href="#__codelineno-10-12">12</a></span>
<span class="normal"><a href="#__codelineno-10-13">13</a></span>
<span class="normal"><a href="#__codelineno-10-14">14</a></span>
<span class="normal"><a href="#__codelineno-10-15">15</a></span>
<span class="normal"><a href="#__codelineno-10-16">16</a></span>
<span class="normal"><a href="#__codelineno-10-17">17</a></span>
<span class="normal"><a href="#__codelineno-10-18">18</a></span>
<span class="normal"><a href="#__codelineno-10-19">19</a></span>
<span class="normal"><a href="#__codelineno-10-20">20</a></span>
<span class="normal"><a href="#__codelineno-10-21">21</a></span>
<span class="normal"><a href="#__codelineno-10-22">22</a></span>
<span class="normal"><a href="#__codelineno-10-23">23</a></span>
<span class="normal"><a href="#__codelineno-10-24">24</a></span>
<span class="normal"><a href="#__codelineno-10-25">25</a></span>
<span class="normal"><a href="#__codelineno-10-26">26</a></span>
<span class="normal"><a href="#__codelineno-10-27">27</a></span>
<span class="normal"><a href="#__codelineno-10-28">28</a></span>
<span class="normal"><a href="#__codelineno-10-29">29</a></span>
<span class="normal"><a href="#__codelineno-10-30">30</a></span>
<span class="normal"><a href="#__codelineno-10-31">31</a></span>
<span class="normal"><a href="#__codelineno-10-32">32</a></span>
<span class="normal"><a href="#__codelineno-10-33">33</a></span>
<span class="normal"><a href="#__codelineno-10-34">34</a></span>
<span class="normal"><a href="#__codelineno-10-35">35</a></span>
<span class="normal"><a href="#__codelineno-10-36">36</a></span>
<span class="normal"><a href="#__codelineno-10-37">37</a></span>
<span class="normal"><a href="#__codelineno-10-38">38</a></span>
<span class="normal"><a href="#__codelineno-10-39">39</a></span>
<span class="normal"><a href="#__codelineno-10-40">40</a></span>
<span class="normal"><a href="#__codelineno-10-41">41</a></span>
<span class="normal"><a href="#__codelineno-10-42">42</a></span>
<span class="normal"><a href="#__codelineno-10-43">43</a></span>
<span class="normal"><a href="#__codelineno-10-44">44</a></span>
<span class="normal"><a href="#__codelineno-10-45">45</a></span>
<span class="normal"><a href="#__codelineno-10-46">46</a></span>
<span class="normal"><a href="#__codelineno-10-47">47</a></span>
<span class="normal"><a href="#__codelineno-10-48">48</a></span>
<span class="normal"><a href="#__codelineno-10-49">49</a></span>
<span class="normal"><a href="#__codelineno-10-50">50</a></span>
<span class="normal"><a href="#__codelineno-10-51">51</a></span>
<span class="normal"><a href="#__codelineno-10-52">52</a></span>
<span class="normal"><a href="#__codelineno-10-53">53</a></span>
<span class="normal"><a href="#__codelineno-10-54">54</a></span>
<span class="normal"><a href="#__codelineno-10-55">55</a></span>
<span class="normal"><a href="#__codelineno-10-56">56</a></span>
<span class="normal"><a href="#__codelineno-10-57">57</a></span>
<span class="normal"><a href="#__codelineno-10-58">58</a></span>
<span class="normal"><a href="#__codelineno-10-59">59</a></span>
<span class="normal"><a href="#__codelineno-10-60">60</a></span>
<span class="normal"><a href="#__codelineno-10-61">61</a></span>
<span class="normal"><a href="#__codelineno-10-62">62</a></span>
<span class="normal"><a href="#__codelineno-10-63">63</a></span>
<span class="normal"><a href="#__codelineno-10-64">64</a></span>
<span class="normal"><a href="#__codelineno-10-65">65</a></span>
<span class="normal"><a href="#__codelineno-10-66">66</a></span>
<span class="normal"><a href="#__codelineno-10-67">67</a></span>
<span class="normal"><a href="#__codelineno-10-68">68</a></span>
<span class="normal"><a href="#__codelineno-10-69">69</a></span>
<span class="normal"><a href="#__codelineno-10-70">70</a></span>
<span class="normal"><a href="#__codelineno-10-71">71</a></span>
<span class="normal"><a href="#__codelineno-10-72">72</a></span>
<span class="normal"><a href="#__codelineno-10-73">73</a></span>
<span class="normal"><a href="#__codelineno-10-74">74</a></span>
<span class="normal"><a href="#__codelineno-10-75">75</a></span>
<span class="normal"><a href="#__codelineno-10-76">76</a></span>
<span class="normal"><a href="#__codelineno-10-77">77</a></span>
<span class="normal"><a href="#__codelineno-10-78">78</a></span>
<span class="normal"><a href="#__codelineno-10-79">79</a></span>
<span class="normal"><a href="#__codelineno-10-80">80</a></span>
<span class="normal"><a href="#__codelineno-10-81">81</a></span>
<span class="normal"><a href="#__codelineno-10-82">82</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">fsspec.implementations.local</span><span class="w"> </span><span class="kn">import</span> <span class="n">LocalFileSystem</span>
<a id="__codelineno-10-2" name="__codelineno-10-2"></a>
<a id="__codelineno-10-3" name="__codelineno-10-3"></a><span class="n">fs</span> <span class="o">=</span> <span class="n">LocalFileSystem</span><span class="p">()</span>
<a id="__codelineno-10-4" name="__codelineno-10-4"></a><span class="c1"># Create dataset</span>
<a id="__codelineno-10-5" name="__codelineno-10-5"></a><span class="n">ds</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">pydala_dataset</span><span class="p">(</span>
<a id="__codelineno-10-6" name="__codelineno-10-6"></a>    <span class="s2">&quot;data/&quot;</span><span class="p">,</span>
<a id="__codelineno-10-7" name="__codelineno-10-7"></a>    <span class="n">partitioning</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span>
<a id="__codelineno-10-8" name="__codelineno-10-8"></a><span class="p">)</span>
<a id="__codelineno-10-9" name="__codelineno-10-9"></a>
<a id="__codelineno-10-10" name="__codelineno-10-10"></a><span class="c1"># Write with delta support</span>
<a id="__codelineno-10-11" name="__codelineno-10-11"></a><span class="n">ds</span><span class="o">.</span><span class="n">write_to_dataset</span><span class="p">(</span>
<a id="__codelineno-10-12" name="__codelineno-10-12"></a>    <span class="n">new_data</span><span class="p">,</span>
<a id="__codelineno-10-13" name="__codelineno-10-13"></a>    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;delta&quot;</span><span class="p">,</span>
<a id="__codelineno-10-14" name="__codelineno-10-14"></a>    <span class="n">delta_subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
<a id="__codelineno-10-15" name="__codelineno-10-15"></a><span class="p">)</span>
<a id="__codelineno-10-16" name="__codelineno-10-16"></a>
<a id="__codelineno-10-17" name="__codelineno-10-17"></a><span class="c1"># Read with metadata</span>
<a id="__codelineno-10-18" name="__codelineno-10-18"></a><span class="n">df</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">to_polars</span><span class="p">()</span>
<a id="__codelineno-10-19" name="__codelineno-10-19"></a><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<a id="__codelineno-10-20" name="__codelineno-10-20"></a><span class="err">```</span><span class="o">--&gt;</span>
<a id="__codelineno-10-21" name="__codelineno-10-21"></a>
<a id="__codelineno-10-22" name="__codelineno-10-22"></a><span class="o">---</span>
<a id="__codelineno-10-23" name="__codelineno-10-23"></a>
<a id="__codelineno-10-24" name="__codelineno-10-24"></a><span class="c1">## `write_parquet()`</span>
<a id="__codelineno-10-25" name="__codelineno-10-25"></a>
<a id="__codelineno-10-26" name="__codelineno-10-26"></a><span class="n">Write</span> <span class="n">data</span> <span class="n">to</span> <span class="n">a</span> <span class="n">Parquet</span> <span class="n">file</span> <span class="k">with</span> <span class="n">automatic</span> <span class="nb">format</span> <span class="n">conversion</span><span class="o">.</span>
<a id="__codelineno-10-27" name="__codelineno-10-27"></a>
<a id="__codelineno-10-28" name="__codelineno-10-28"></a><span class="n">Handles</span> <span class="n">writing</span> <span class="n">data</span> <span class="kn">from</span><span class="w"> </span><span class="nn">multiple</span> <span class="nb">input</span> <span class="n">formats</span> <span class="n">to</span> <span class="n">Parquet</span> <span class="k">with</span><span class="p">:</span>
<a id="__codelineno-10-29" name="__codelineno-10-29"></a>
<a id="__codelineno-10-30" name="__codelineno-10-30"></a><span class="o">-</span> <span class="n">Automatic</span> <span class="n">conversion</span> <span class="n">to</span> <span class="n">PyArrow</span>
<a id="__codelineno-10-31" name="__codelineno-10-31"></a><span class="o">-</span> <span class="n">Schema</span> <span class="n">validation</span><span class="o">/</span><span class="n">coercion</span>
<a id="__codelineno-10-32" name="__codelineno-10-32"></a><span class="o">-</span> <span class="n">Metadata</span> <span class="n">collection</span>
<a id="__codelineno-10-33" name="__codelineno-10-33"></a><span class="o">-</span> <span class="n">Compression</span> <span class="ow">and</span> <span class="n">encoding</span> <span class="n">options</span>
<a id="__codelineno-10-34" name="__codelineno-10-34"></a>
<a id="__codelineno-10-35" name="__codelineno-10-35"></a><span class="o">|</span> <span class="n">Parameter</span> <span class="o">|</span> <span class="n">Type</span> <span class="o">|</span> <span class="n">Description</span> <span class="o">|</span>
<a id="__codelineno-10-36" name="__codelineno-10-36"></a><span class="o">|</span> <span class="p">:</span><span class="o">--------</span> <span class="o">|</span> <span class="p">:</span><span class="o">---</span> <span class="o">|</span> <span class="p">:</span><span class="o">----------</span> <span class="o">|</span>
<a id="__codelineno-10-37" name="__codelineno-10-37"></a><span class="o">|</span> <span class="err">`</span><span class="n">data</span><span class="err">`</span> <span class="o">|</span> <span class="err">`</span><span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="err">`</span> <span class="ow">or</span> <span class="err">`</span><span class="n">pl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="err">`</span> <span class="ow">or</span> <span class="err">`</span><span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="err">`</span> <span class="ow">or</span> <span class="err">`</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="err">`</span> <span class="ow">or</span> <span class="err">`</span><span class="nb">dict</span><span class="err">`</span> <span class="ow">or</span> <span class="err">`</span><span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span><span class="err">`</span> <span class="o">|</span> <span class="n">Input</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">various</span> <span class="n">formats</span><span class="p">:</span> <span class="o">-</span> <span class="n">Polars</span> <span class="n">DataFrame</span><span class="o">/</span><span class="n">LazyFrame</span> <span class="o">-</span> <span class="n">PyArrow</span> <span class="n">Table</span> <span class="o">-</span> <span class="n">Pandas</span> <span class="n">DataFrame</span> <span class="o">-</span> <span class="n">Dict</span> <span class="ow">or</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">dicts</span> <span class="o">|</span>
<a id="__codelineno-10-38" name="__codelineno-10-38"></a><span class="o">|</span> <span class="err">`</span><span class="n">path</span><span class="err">`</span> <span class="o">|</span> <span class="err">`</span><span class="nb">str</span><span class="err">`</span> <span class="o">|</span> <span class="n">Output</span> <span class="n">Parquet</span> <span class="n">file</span> <span class="n">path</span> <span class="o">|</span>
<a id="__codelineno-10-39" name="__codelineno-10-39"></a><span class="o">|</span> <span class="err">`</span><span class="n">schema</span><span class="err">`</span> <span class="o">|</span> <span class="err">`</span><span class="n">pa</span><span class="o">.</span><span class="n">Schema</span> <span class="o">|</span> <span class="kc">None</span><span class="err">`</span> <span class="o">|</span> <span class="n">Optional</span> <span class="n">schema</span> <span class="n">to</span> <span class="n">enforce</span> <span class="n">on</span> <span class="n">write</span> <span class="o">|</span>
<a id="__codelineno-10-40" name="__codelineno-10-40"></a><span class="o">|</span> <span class="err">`</span><span class="o">**</span><span class="n">kwargs</span><span class="err">`</span> <span class="o">|</span> <span class="err">`</span><span class="n">Any</span><span class="err">`</span> <span class="o">|</span> <span class="n">Additional</span> <span class="n">arguments</span> <span class="k">for</span> <span class="err">`</span><span class="n">pq</span><span class="o">.</span><span class="n">write_table</span><span class="p">()</span><span class="err">`</span> <span class="o">|</span>
<a id="__codelineno-10-41" name="__codelineno-10-41"></a>
<a id="__codelineno-10-42" name="__codelineno-10-42"></a><span class="o">|</span> <span class="n">Returns</span> <span class="o">|</span> <span class="n">Type</span> <span class="o">|</span> <span class="n">Description</span> <span class="o">|</span>
<a id="__codelineno-10-43" name="__codelineno-10-43"></a><span class="o">|</span> <span class="p">:</span><span class="o">------</span> <span class="o">|</span> <span class="p">:</span><span class="o">---</span> <span class="o">|</span> <span class="p">:</span><span class="o">----------</span> <span class="o">|</span>
<a id="__codelineno-10-44" name="__codelineno-10-44"></a><span class="o">|</span> <span class="err">`</span><span class="n">pq</span><span class="o">.</span><span class="n">FileMetaData</span><span class="err">`</span> <span class="o">|</span> <span class="err">`</span><span class="n">pq</span><span class="o">.</span><span class="n">FileMetaData</span><span class="err">`</span> <span class="o">|</span> <span class="n">Metadata</span> <span class="n">of</span> <span class="n">written</span> <span class="n">Parquet</span> <span class="n">file</span> <span class="o">|</span>
<a id="__codelineno-10-45" name="__codelineno-10-45"></a>
<a id="__codelineno-10-46" name="__codelineno-10-46"></a><span class="o">|</span> <span class="n">Raises</span> <span class="o">|</span> <span class="n">Type</span> <span class="o">|</span> <span class="n">Description</span> <span class="o">|</span>
<a id="__codelineno-10-47" name="__codelineno-10-47"></a><span class="o">|</span> <span class="p">:</span><span class="o">-----</span> <span class="o">|</span> <span class="p">:</span><span class="o">---</span> <span class="o">|</span> <span class="p">:</span><span class="o">----------</span> <span class="o">|</span>
<a id="__codelineno-10-48" name="__codelineno-10-48"></a><span class="o">|</span> <span class="err">`</span><span class="n">SchemaError</span><span class="err">`</span> <span class="o">|</span> <span class="err">`</span><span class="n">SchemaError</span><span class="err">`</span> <span class="o">|</span> <span class="n">If</span> <span class="n">data</span> <span class="n">doesn</span><span class="s1">&#39;t match schema |</span>
<a id="__codelineno-10-49" name="__codelineno-10-49"></a><span class="o">|</span> <span class="err">`</span><span class="ne">ValueError</span><span class="err">`</span> <span class="o">|</span> <span class="err">`</span><span class="ne">ValueError</span><span class="err">`</span> <span class="o">|</span> <span class="n">If</span> <span class="n">data</span> <span class="n">cannot</span> <span class="n">be</span> <span class="n">converted</span> <span class="o">|</span>
<a id="__codelineno-10-50" name="__codelineno-10-50"></a>
<a id="__codelineno-10-51" name="__codelineno-10-51"></a><span class="o">**</span><span class="n">Example</span><span class="p">:</span><span class="o">**</span>
<a id="__codelineno-10-52" name="__codelineno-10-52"></a>
<a id="__codelineno-10-53" name="__codelineno-10-53"></a><span class="err">```</span><span class="n">python</span>
<a id="__codelineno-10-54" name="__codelineno-10-54"></a><span class="kn">from</span><span class="w"> </span><span class="nn">fsspec.implementations.local</span><span class="w"> </span><span class="kn">import</span> <span class="n">LocalFileSystem</span>
<a id="__codelineno-10-55" name="__codelineno-10-55"></a><span class="kn">import</span><span class="w"> </span><span class="nn">polars</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pl</span>
<a id="__codelineno-10-56" name="__codelineno-10-56"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-10-57" name="__codelineno-10-57"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pyarrow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pa</span>
<a id="__codelineno-10-58" name="__codelineno-10-58"></a>
<a id="__codelineno-10-59" name="__codelineno-10-59"></a><span class="n">fs</span> <span class="o">=</span> <span class="n">LocalFileSystem</span><span class="p">()</span>
<a id="__codelineno-10-60" name="__codelineno-10-60"></a><span class="c1"># Write Polars DataFrame</span>
<a id="__codelineno-10-61" name="__codelineno-10-61"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<a id="__codelineno-10-62" name="__codelineno-10-62"></a>    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span>
<a id="__codelineno-10-63" name="__codelineno-10-63"></a>    <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
<a id="__codelineno-10-64" name="__codelineno-10-64"></a><span class="p">})</span>
<a id="__codelineno-10-65" name="__codelineno-10-65"></a><span class="n">metadata</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">write_parquet</span><span class="p">(</span>
<a id="__codelineno-10-66" name="__codelineno-10-66"></a>    <span class="n">df</span><span class="p">,</span>
<a id="__codelineno-10-67" name="__codelineno-10-67"></a>    <span class="s2">&quot;data.parquet&quot;</span><span class="p">,</span>
<a id="__codelineno-10-68" name="__codelineno-10-68"></a>    <span class="n">compression</span><span class="o">=</span><span class="s2">&quot;zstd&quot;</span><span class="p">,</span>
<a id="__codelineno-10-69" name="__codelineno-10-69"></a>    <span class="n">compression_level</span><span class="o">=</span><span class="mi">3</span>
<a id="__codelineno-10-70" name="__codelineno-10-70"></a><span class="p">)</span>
<a id="__codelineno-10-71" name="__codelineno-10-71"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Rows: </span><span class="si">{</span><span class="n">metadata</span><span class="o">.</span><span class="n">num_rows</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-10-72" name="__codelineno-10-72"></a>
<a id="__codelineno-10-73" name="__codelineno-10-73"></a><span class="c1"># Write with schema</span>
<a id="__codelineno-10-74" name="__codelineno-10-74"></a><span class="n">schema</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">schema</span><span class="p">([</span>
<a id="__codelineno-10-75" name="__codelineno-10-75"></a>    <span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int64</span><span class="p">()),</span>
<a id="__codelineno-10-76" name="__codelineno-10-76"></a>    <span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">float64</span><span class="p">())</span>
<a id="__codelineno-10-77" name="__codelineno-10-77"></a><span class="p">])</span>
<a id="__codelineno-10-78" name="__codelineno-10-78"></a><span class="n">metadata</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">write_parquet</span><span class="p">(</span>
<a id="__codelineno-10-79" name="__codelineno-10-79"></a>    <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">]},</span>
<a id="__codelineno-10-80" name="__codelineno-10-80"></a>    <span class="s2">&quot;data.parquet&quot;</span><span class="p">,</span>
<a id="__codelineno-10-81" name="__codelineno-10-81"></a>    <span class="n">schema</span><span class="o">=</span><span class="n">schema</span>
<a id="__codelineno-10-82" name="__codelineno-10-82"></a><span class="p">)</span>
</code></pre></div></td></tr></table></div>

---

## `write_json()`

Write data to a JSON file with flexible input support.

Handles writing data in various formats to JSON or JSON Lines, with optional appending for streaming writes.

| Parameter | Type | Description |
| :-------- | :--- | :---------- |
| `data` | `dict` or `pl.DataFrame` or `pl.LazyFrame` or `pa.Table` or `pd.DataFrame` or `dict` or `list[dict]` | Input data in various formats: - Dict or list of dicts - Polars DataFrame/LazyFrame - PyArrow Table - Pandas DataFrame |
| `path` | `str` | Output JSON file path |
| `append` | `bool` | Whether to append to existing file (JSON Lines mode) |

**Example:**

<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-11-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-11-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-11-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-11-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-11-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-11-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-11-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-11-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-11-10">10</a></span>
<span class="normal"><a href="#__codelineno-11-11">11</a></span>
<span class="normal"><a href="#__codelineno-11-12">12</a></span>
<span class="normal"><a href="#__codelineno-11-13">13</a></span>
<span class="normal"><a href="#__codelineno-11-14">14</a></span>
<span class="normal"><a href="#__codelineno-11-15">15</a></span>
<span class="normal"><a href="#__codelineno-11-16">16</a></span>
<span class="normal"><a href="#__codelineno-11-17">17</a></span>
<span class="normal"><a href="#__codelineno-11-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">fsspec.implementations.local</span><span class="w"> </span><span class="kn">import</span> <span class="n">LocalFileSystem</span>
<a id="__codelineno-11-2" name="__codelineno-11-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">polars</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pl</span>
<a id="__codelineno-11-3" name="__codelineno-11-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pyarrow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pa</span>
<a id="__codelineno-11-4" name="__codelineno-11-4"></a>
<a id="__codelineno-11-5" name="__codelineno-11-5"></a><span class="n">fs</span> <span class="o">=</span> <span class="n">LocalFileSystem</span><span class="p">()</span>
<a id="__codelineno-11-6" name="__codelineno-11-6"></a><span class="c1"># Write dictionary</span>
<a id="__codelineno-11-7" name="__codelineno-11-7"></a><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]}</span>
<a id="__codelineno-11-8" name="__codelineno-11-8"></a><span class="n">fs</span><span class="o">.</span><span class="n">write_json</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;config.json&quot;</span><span class="p">)</span>
<a id="__codelineno-11-9" name="__codelineno-11-9"></a>
<a id="__codelineno-11-10" name="__codelineno-11-10"></a><span class="c1"># Stream records</span>
<a id="__codelineno-11-11" name="__codelineno-11-11"></a><span class="n">df1</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;first&quot;</span><span class="p">]})</span>
<a id="__codelineno-11-12" name="__codelineno-11-12"></a><span class="n">df2</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;second&quot;</span><span class="p">]})</span>
<a id="__codelineno-11-13" name="__codelineno-11-13"></a><span class="n">fs</span><span class="o">.</span><span class="n">write_json</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="s2">&quot;stream.jsonl&quot;</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-11-14" name="__codelineno-11-14"></a><span class="n">fs</span><span class="o">.</span><span class="n">write_json</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="s2">&quot;stream.jsonl&quot;</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-11-15" name="__codelineno-11-15"></a>
<a id="__codelineno-11-16" name="__codelineno-11-16"></a><span class="c1"># Convert PyArrow</span>
<a id="__codelineno-11-17" name="__codelineno-11-17"></a><span class="n">table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">table</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">]})</span>
<a id="__codelineno-11-18" name="__codelineno-11-18"></a><span class="n">fs</span><span class="o">.</span><span class="n">write_json</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="s2">&quot;data.json&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

---

## `write_csv()`

Write data to a CSV file with flexible input support.

Handles writing data from multiple formats to CSV with options for:

- Appending to existing files
- Custom delimiters and formatting
- Automatic type conversion
- Header handling

| Parameter | Type | Description |
| :-------- | :--- | :---------- |
| `data` | `pl.DataFrame` or `pl.LazyFrame` or `pa.Table` or `pd.DataFrame` or `dict` or `list[dict]` | Input data in various formats: - Polars DataFrame/LazyFrame - PyArrow Table - Pandas DataFrame - Dict or list of dicts |
| `path` | `str` | Output CSV file path |
| `append` | `bool` | Whether to append to existing file |
| `**kwargs` | `Any` | Additional arguments for CSV writing: - `delimiter`: Field separator (default ",") - `header`: Whether to write header row - `quote_char`: Character for quoting fields - `date_format`: Format for date/time fields - `float_precision`: Decimal places for floats |

**Example:**

<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-12-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-12-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-12-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-12-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-12-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-12-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-12-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-12-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-12-10">10</a></span>
<span class="normal"><a href="#__codelineno-12-11">11</a></span>
<span class="normal"><a href="#__codelineno-12-12">12</a></span>
<span class="normal"><a href="#__codelineno-12-13">13</a></span>
<span class="normal"><a href="#__codelineno-12-14">14</a></span>
<span class="normal"><a href="#__codelineno-12-15">15</a></span>
<span class="normal"><a href="#__codelineno-12-16">16</a></span>
<span class="normal"><a href="#__codelineno-12-17">17</a></span>
<span class="normal"><a href="#__codelineno-12-18">18</a></span>
<span class="normal"><a href="#__codelineno-12-19">19</a></span>
<span class="normal"><a href="#__codelineno-12-20">20</a></span>
<span class="normal"><a href="#__codelineno-12-21">21</a></span>
<span class="normal"><a href="#__codelineno-12-22">22</a></span>
<span class="normal"><a href="#__codelineno-12-23">23</a></span>
<span class="normal"><a href="#__codelineno-12-24">24</a></span>
<span class="normal"><a href="#__codelineno-12-25">25</a></span>
<span class="normal"><a href="#__codelineno-12-26">26</a></span>
<span class="normal"><a href="#__codelineno-12-27">27</a></span>
<span class="normal"><a href="#__codelineno-12-28">28</a></span>
<span class="normal"><a href="#__codelineno-12-29">29</a></span>
<span class="normal"><a href="#__codelineno-12-30">30</a></span>
<span class="normal"><a href="#__codelineno-12-31">31</a></span>
<span class="normal"><a href="#__codelineno-12-32">32</a></span>
<span class="normal"><a href="#__codelineno-12-33">33</a></span>
<span class="normal"><a href="#__codelineno-12-34">34</a></span>
<span class="normal"><a href="#__codelineno-12-35">35</a></span>
<span class="normal"><a href="#__codelineno-12-36">36</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">fsspec.implementations.local</span><span class="w"> </span><span class="kn">import</span> <span class="n">LocalFileSystem</span>
<a id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">polars</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pl</span>
<a id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<a id="__codelineno-12-4" name="__codelineno-12-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pyarrow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pa</span>
<a id="__codelineno-12-5" name="__codelineno-12-5"></a>
<a id="__codelineno-12-6" name="__codelineno-12-6"></a><span class="n">fs</span> <span class="o">=</span> <span class="n">LocalFileSystem</span><span class="p">()</span>
<a id="__codelineno-12-7" name="__codelineno-12-7"></a><span class="c1"># Write Polars DataFrame</span>
<a id="__codelineno-12-8" name="__codelineno-12-8"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<a id="__codelineno-12-9" name="__codelineno-12-9"></a>    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span>
<a id="__codelineno-12-10" name="__codelineno-12-10"></a>    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;item_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)]</span>
<a id="__codelineno-12-11" name="__codelineno-12-11"></a><span class="p">})</span>
<a id="__codelineno-12-12" name="__codelineno-12-12"></a><span class="n">fs</span><span class="o">.</span><span class="n">write_csv</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;items.csv&quot;</span><span class="p">)</span>
<a id="__codelineno-12-13" name="__codelineno-12-13"></a>
<a id="__codelineno-12-14" name="__codelineno-12-14"></a><span class="c1"># Append records</span>
<a id="__codelineno-12-15" name="__codelineno-12-15"></a><span class="n">new_items</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<a id="__codelineno-12-16" name="__codelineno-12-16"></a>    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span>
<a id="__codelineno-12-17" name="__codelineno-12-17"></a>    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;item_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">)]</span>
<a id="__codelineno-12-18" name="__codelineno-12-18"></a><span class="p">})</span>
<a id="__codelineno-12-19" name="__codelineno-12-19"></a><span class="n">fs</span><span class="o">.</span><span class="n">write_csv</span><span class="p">(</span>
<a id="__codelineno-12-20" name="__codelineno-12-20"></a>    <span class="n">new_items</span><span class="p">,</span>
<a id="__codelineno-12-21" name="__codelineno-12-21"></a>    <span class="s2">&quot;items.csv&quot;</span><span class="p">,</span>
<a id="__codelineno-12-22" name="__codelineno-12-22"></a>    <span class="n">append</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-12-23" name="__codelineno-12-23"></a>    <span class="n">header</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-12-24" name="__codelineno-12-24"></a><span class="p">)</span>
<a id="__codelineno-12-25" name="__codelineno-12-25"></a>
<a id="__codelineno-12-26" name="__codelineno-12-26"></a><span class="c1"># Custom formatting</span>
<a id="__codelineno-12-27" name="__codelineno-12-27"></a><span class="n">data</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">table</span><span class="p">({</span>
<a id="__codelineno-12-28" name="__codelineno-12-28"></a>    <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()],</span>
<a id="__codelineno-12-29" name="__codelineno-12-29"></a>    <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">123.456</span><span class="p">]</span>
<a id="__codelineno-12-30" name="__codelineno-12-30"></a><span class="p">})</span>
<a id="__codelineno-12-31" name="__codelineno-12-31"></a><span class="n">fs</span><span class="o">.</span><span class="n">write_csv</span><span class="p">(</span>
<a id="__codelineno-12-32" name="__codelineno-12-32"></a>    <span class="n">data</span><span class="p">,</span>
<a id="__codelineno-12-33" name="__codelineno-12-33"></a>    <span class="s2">&quot;formatted.csv&quot;</span><span class="p">,</span>
<a id="__codelineno-12-34" name="__codelineno-12-34"></a>    <span class="n">date_format</span><span class="o">=</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-12-35" name="__codelineno-12-35"></a>    <span class="n">float_precision</span><span class="o">=</span><span class="mi">2</span>
<a id="__codelineno-12-36" name="__codelineno-12-36"></a><span class="p">)</span>
</code></pre></div></td></tr></table></div>

---

## `write_file()`

Write a DataFrame to a file in the given format.

| Parameter | Type | Description |
| :-------- | :--- | :---------- |
| `data` | `pl.DataFrame` or `pl.LazyFrame` or `pa.Table` or `pd.DataFrame` or `dict` | Data to write. |
| `path` | `str` | Path to write the data. |
| `format` | `str` | Format of the file. |
| `**kwargs` | `Any` | Additional keyword arguments. |

| Returns | Type | Description |
| :------ | :--- | :---------- |
| `None` | `None` | |

---

## `write_files()`

Write a DataFrame or a list of DataFrames to a file or a list of files.

| Parameter | Type | Description |
| :-------- | :--- | :---------- |
| `data` | `pl.DataFrame` or `pl.LazyFrame` or `pa.Table` or `pa.RecordBatch` or `pa.RecordBatchReader` or `pd.DataFrame` or `dict` or `list[pl.DataFrame` or `pl.LazyFrame` or `pa.Table` or `pa.RecordBatch` or `pa.RecordBatchReader` or `pd.DataFrame` or `dict]` | Data to write. |
| `path` | `str` or `list[str]` | Path to write the data. |
| `basename` | `str` | Basename of the files. Defaults to None. |
| `format` | `str` | Format of the data. Defaults to None. |
| `concat` | `bool` | If True, concatenate the DataFrames. Defaults to True. |
| `unique` | `bool` or `list[str]` or `str` | If True, remove duplicates. Defaults to False. |
| `mode` | `str` | Write mode. Defaults to 'append'. Options: 'append', 'overwrite', 'delete_matching', 'error_if_exists'. |
| `use_threads` | `bool` | If True, use parallel processing. Defaults to True. |
| `verbose` | `bool` | If True, print verbose output. Defaults to True. |
| `**kwargs` | `Any` | Additional keyword arguments. |

| Returns | Type | Description |
| :------ | :--- | :---------- |
| `None` | `None` | |

| Raises | Type | Description |
| :----- | :--- | :---------- |
| `FileExistsError` | `FileExistsError` | If file already exists and mode is 'error_if_exists'. |

---

## `write_pyarrow_dataset()`

Write a tabular data to a PyArrow dataset.

| Parameter | Type | Description |
| :-------- | :--- | :---------- |
| `data` | `pl.DataFrame` or `pa.Table` or `pa.RecordBatch` or `pa.RecordBatchReader` or `pd.DataFrame` or `list[pl.DataFrame]` or `list[pa.Table]` or `list[pa.RecordBatch]` or `list[pa.RecordBatchReader]` or `list[pd.DataFrame]` | Data to write. |
| `path` | `str` | Path to write the data. |
| `basename` | `str | None` | Basename of the files. Defaults to None. |
| `schema` | `pa.Schema | None` | Schema of the data. Defaults to None. |
| `partition_by` | `str` or `list[str]` or `pds.Partitioning` or `None` | Partitioning of the data. Defaults to None. |
| `partitioning_flavor` | `str` | Partitioning flavor. Defaults to 'hive'. |
| `mode` | `str` | Write mode. Defaults to 'append'. |
| `format` | `str | None` | Format of the data. Defaults to 'parquet'. |
| `compression` | `str` | Compression algorithm. Defaults to 'zstd'. |
| `max_rows_per_file` | `int | None` | Maximum number of rows per file. Defaults to 2,500,000. |
| `row_group_size` | `int | None` | Row group size. Defaults to 250,000. |
| `concat` | `bool` | If True, concatenate the DataFrames. Defaults to True. |
| `unique` | `bool` or `str` or `list[str]` | If True, remove duplicates. Defaults to False. |
| `**kwargs` | `Any` | Additional keyword arguments for `pds.write_dataset`. |

| Returns | Type | Description |
| :------ | :--- | :---------- |
| `list[pq.FileMetaData]` or `None` | List of Parquet file metadata or None. |

<!-----

## `write_pydala_dataset()`

Write a tabular data to a Pydala dataset.

| Parameter | Type | Description |
| :-------- | :--- | :---------- |
| `data` | `pl.DataFrame` or `pa.Table` or `pa.RecordBatch` or `pa.RecordBatchReader` or `pd.DataFrame` or `list[pl.DataFrame]` or `list[pa.Table]` or `list[pa.RecordBatch]` or `list[pa.RecordBatchReader]` or `list[pd.DataFrame]` | Data to write. |
| `path` | `str` | Path to write the data. |
| `mode` | `str` | Write mode. Defaults to 'append'. Options: 'delta', 'overwrite'. |
| `basename` | `str | None` | Basename of the files. Defaults to None. |
| `partition_by` | `str` or `list[str]` or `None` | Partitioning of the data. Defaults to None. |
| `partitioning_flavor` | `str` | Partitioning flavor. Defaults to 'hive'. |
| `max_rows_per_file` | `int | None` | Maximum number of rows per file. Defaults to 2,500,000. |
| `row_group_size` | `int | None` | Row group size. Defaults to 250,000. |
| `compression` | `str` | Compression algorithm. Defaults to 'zstd'. |
| `sort_by` | `str` or `list[str]` or `list[tuple[str, str]]` or `None` | Columns to sort by. Defaults to None. |
| `unique` | `bool` or `str` or `list[str]` | If True, ensure unique values. Defaults to False. |
| `delta_subset` | `str` or `list[str]` or `None` | Subset of columns to include in delta table. Defaults to None. |
| `update_metadata` | `bool` | If True, update metadata. Defaults to True. |
| `alter_schema` | `bool` | If True, alter schema. Defaults to False. |
| `timestamp_column` | `str` or `None` | Timestamp column. Defaults to None. |
| `verbose` | `bool` | If True, print verbose output. Defaults to True. |
| `**kwargs` | `Any` | Additional keyword arguments for `ParquetDataset.write_to_dataset`. |

| Returns | Type | Description |
| :------ | :--- | :---------- |
| `None` | `None` | |-->












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "search.suggest", "search.highlight", "toc.integrate"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="https://unpkg.com/mermaid@10.4.0/dist/mermaid.min.js"></script>
      
        <script src="../../javascripts/mermaid.js"></script>
      
    
  </body>
</html>